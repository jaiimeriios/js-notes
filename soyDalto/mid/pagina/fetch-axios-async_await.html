<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta name="description" content="html5 Template" />
    <title>Fetch Axios Async & Await</title>
    <link rel="icon" href="https://raw.githubusercontent.com/jaiimeriios/html5-Main-Template/master/favicon.ico" />
    <link href="../../css/normalize.css" rel="stylesheet" media="all" />
    <link href="../../css/styles.css" rel="stylesheet" media="all" />
</head>

<body>
    <div class="container">
        <h1>Fetch Axios Async & Await</h1>
    </div>
    <div class="container">
        <div>
            <button type="button" id="boton">Nombre</button>
            <button type="button" id="boton2">Nombre 2</button>
            <button type="button" id="boton3">Nombre 3</button>
            <input type="number" min="0" max="5" id="numero" value="5">
        </div>
        <p id="nombre"></p>
        <div id="contenedor"></div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script>
        const url = 'https://reqres.in/api/users'
        const contenedor = document.querySelector('#contenedor')
        const boton = document.querySelector('#boton')
        const boton2 = document.querySelector('#boton2')
        const boton3 = document.querySelector('#boton3')
        const nombre = document.querySelector('#nombre')
        const numero = document.querySelector('#numero')

        // peticion async await
        const getName = async () => {
            let peticion = await fetch(url)
            let resultado = await peticion.json()
            console.log(resultado)

            const div = document.createElement('div')
            const img = document.createElement('img')
            const p = document.createElement('p')
            const email = document.createElement('p')

            let data = resultado.data[numero.value]

            img.src = `${data.avatar}`
            p.innerHTML = `${data.first_name} ${data.last_name}`
            email.innerHTML = `${data.email}`

            div.insertAdjacentElement('beforeend', img)
            div.insertAdjacentElement('beforeend', p)
            div.insertAdjacentElement('beforeend', email)

            contenedor.insertAdjacentElement('afterbegin', div)
        }

        boton.addEventListener('click', getName)

        // Petision con AXIOS
        const getName2 = async () => {
            let peticion = await axios(url)
            console.log('AXIOS::', peticion)

            nombre.innerHTML = peticion.data.data[numero.value].first_name
        }
        boton2.addEventListener('click', getName2)


        // error the API
        const getName3 = async () => {
            try {
                let peticion = await axios('api que no existe')
                console.log('AXIOS::', peticion)
                nombre.innerHTML = peticion.data.data[numero.value].first_name
            } catch (e) {
                return console.log(e)
            }
        }
        boton3.addEventListener('click', getName3)

    </script>
</body>

</html>